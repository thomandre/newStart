if(typeof TOPI_isLoadedSwfStore==='undefined'){var TOPI_isLoadedSwfStore=true;(function(){"use strict";var counter=0;var alpnum=/[^a-z0-9_]/ig;window.SwfStore=function(config){config=config||{};var defaults={swf_url:'storage.swf',namespace:'swfstore',path:null,debug:false,timeout:10,onready:null,onerror:null};var key;for(key in defaults){if(defaults.hasOwnProperty(key)){if(!config.hasOwnProperty(key)){config[key]=defaults[key]}}}config.namespace=config.namespace.replace(alpnum,'_');if(window.SwfStore[config.namespace]){throw"There is already an instance of SwfStore using the '"+config.namespace+"' namespace. Use that instance or specify an alternate namespace in the config."}this.config=config;function id(){return"SwfStore_"+config.namespace+"_"+(counter++)}function div(visible){var d=document.createElement('div');document.body.appendChild(d);d.id=id();if(!visible){d.style.position="absolute";d.style.top="-2000px";d.style.left="-2000px"}return d}if(config.debug){if(typeof console==="undefined"){var loggerOutput=div(true);window.console={log:function(msg){var m=div(true);m.innerHTML=msg;loggerOutput.appendChild(m)}}}this.log=function(type,source,msg){source=(source==='swfStore')?'swf':source;if(typeof(console[type])!=="undefined"){console[type]('SwfStore - '+config.namespace+' ('+source+'): '+msg)}else{}}}else{this.log=function(){}}this.log('info','js','Initializing...');SwfStore[config.namespace]=this;var swfContainer=div(config.debug);var swfName=id();var flashvars="logfn=SwfStore."+config.namespace+".log&amp;"+"onload=SwfStore."+config.namespace+".onload&amp;"+"onerror=SwfStore."+config.namespace+".onerror&amp;"+(config.path?"LSOPath="+config.path+'&amp;':'')+"LSOName="+config.namespace;swfContainer.innerHTML='<object height="100" width="500" codebase="https://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" id="'+swfName+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000">'+'	<param value="'+config.swf_url+'" name="movie">'+'	<param value="'+flashvars+'" name="FlashVars">'+'	<param value="always" name="allowScriptAccess">'+'	<embed height="375" align="middle" width="500" pluginspage="https://www.macromedia.com/go/getflashplayer" '+'flashvars="'+flashvars+'" type="application/x-shockwave-flash" allowscriptaccess="always" quality="high" loop="false" play="true" '+'name="'+swfName+'" bgcolor="#ffffff" src="'+config.swf_url+'">'+'</object>';this.swf=document[swfName]||window[swfName];this._timeout=setTimeout(function(){SwfStore[config.namespace].log('error','js','Timeout reached, assuming '+config.swf_url+' failed to load and firing the onerror callback.');if(config.onerror){config.onerror()}},config.timeout*1000)};function checkData(data){if(typeof data==="function"){throw'SwfStore Error: Functions cannot be used as keys or values.'}}SwfStore.prototype={version:"1.7",ready:false,set:function(key,value){this._checkReady();checkData(key);checkData(value);this.log('debug','js','Setting '+key+'='+value);this.swf.set(key,value)},get:function(key){this._checkReady();checkData(key);this.log('debug','js','Reading '+key);return this.swf.get(key)},getAll:function(){this._checkReady();var data=this.swf.getAll();if(data.__flashBugFix){delete data.__flashBugFix}return data},clear:function(key){this._checkReady();checkData(key);this.swf.clear(key)},_checkReady:function(){if(!this.ready){throw'SwfStore is not yet finished initializing. Pass a config.onready callback or wait until this.ready is true before trying to use a SwfStore instance.'}},"onload":function(){var that=this;setTimeout(function(){clearTimeout(that._timeout);that.ready=true;that.set('__flashBugFix','1');if(that.config.onready){that.config.onready()}},0)},onerror:function(){clearTimeout(this._timeout);if(this.config.onerror){this.config.onerror()}}}}())}function CrossDomainStorage(origin,path){this.origin=origin;this.path=path;this._iframe=null;this._iframeReady=false;this._queue=[];this._requests={};this._id=0}if(Object.prototype.toString.call(CrossDomainStorage)!=="[object Object]"){CrossDomainStorage.prototype={constructor:CrossDomainStorage,init:function(){var that=this;if(!this._iframe){if(window.postMessage&&window.JSON&&window.localStorage){this._iframe=document.createElement("iframe");this._iframe.style.cssText="position:absolute;width:1px;height:1px;left:-9999px;";document.body.appendChild(this._iframe);if(window.addEventListener){this._iframe.addEventListener("load",function(){that._iframeLoaded()},false);window.addEventListener("messageTOPI",function(event){that._handleMessage(event)},false)}else if(this._iframe.attachEvent){this._iframe.attachEvent("onload",function(){that._iframeLoaded()},false);window.attachEvent("onmessageTOPI",function(event){that._handleMessage(event)})}}}if(this._iframe){this._iframe.src=this.origin+this.path}},requestValue:function(key,callback,value){var request={key:key,value:value,id:++this._id},data={request:request,callback:callback};if(this._iframeReady){this._sendRequest(data)}else{this._queue.push(data)}if(!this._iframe){this.init()}},_sendRequest:function(data){this._requests[data.request.id]=data;this._iframe.contentWindow.postMessage(JSON.stringify(data.request),this.origin)},_iframeLoaded:function(){this._iframeReady=true;if(this._queue.length){for(var i=0,len=this._queue.length;i<len;i++){this._sendRequest(this._queue[i])}this._queue=[]}},_handleMessage:function(event){var data=JSON.parse(event.data);if(TOPI.isset(this._requests[data.id])){this._requests[data.id].callback(data.key,data.value)}delete this._requests[data.id]}}}if(TOPI instanceof Array){var TOPItmp=TOPI}if(Object.prototype.toString.call(TOPI)!=="[object Object]"){var TOPI={flagLSO:false,flagFP:false,flagLSE:true,flagTDP:false,isAlreadyRunning:false,incrementBanners:0,wucLSO:null,isInit:false,banners:[],technosToMerge:[],fpProg:[],canCallSprinkle:false,counterReadyToSprinkle:0,counterReadyToSprinkleLimit:5,remoteStorage:null,idSession:'5304f492646284.09756928',inArray:function(array,p_val){var n=array.length;for(var i=0;i<n;i++){if(array[i]==p_val){return true}}return false},array_unique:function(inputArr){var key='',tmp_arr2=[],val='';var __array_search=function(needle,haystack){var fkey='';for(fkey in haystack){if(haystack.hasOwnProperty(fkey)){if((haystack[fkey]+'')===(needle+'')){return fkey}}}return false};for(key in inputArr){if(inputArr.hasOwnProperty(key)){val=inputArr[key];if(false===__array_search(val,tmp_arr2)){tmp_arr2[key]=val}}}return tmp_arr2},rawurlencode:function(str){return encodeURIComponent(str).replace(/!/g,'%21').replace(/'/g,'%27').replace(/\(/g,'%28').replace(/\)/g,'%29').replace(/\*/g,'%2A').replace(/\+/g,'%2B')},buildScriptTag:function(webUser,techno){var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src=(document.location.protocol=="https:"?"https":"http")+"://t.publicidees.com//p/topi/cITV2?wu="+this.rawurlencode(webUser)+"&t="+techno+'&s='+this.idSession;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t);if(typeof tip!=="undefined"){tip.setWutoback(webUser)}},readyToSprinkle:function(){for(var techno in cTOPI.pitechnos){switch(cTOPI.pitechnos[techno]){case"LSO":if(this.flagLSO===false){return false}break;case"TDP":if(this.flagTDP===false){return false}break;case"LSE":if(this.flagLSE===false){return false}break;case"FP":if(this.flagFP===false){return false}break}}return true},callSprinkle:function(){var p="";if(this.fpProg.length>0){var progs=this.array_unique(this.fpProg);p+="&p="+progs.join()}var s=document.createElement("script");s.type="text/javascript";s.async=true;s.src=(document.location.protocol=="https:"?"https":"http")+"://t.publicidees.com//p/topi/sprinkle?r="+Math.random().toString()+p+'&s='+this.idSession;var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(s,t)},resetTOPI:function(){this.flagLSO=false;this.flagLS=false;this.flagFP=false;this.flagTDP=false;this.wucLSO=null;this.canCallSprinkle=false;this.technosToMerge=[];this.incrementBanners++},setRunning:function(running){this.isAlreadyRunning=running},getRunning:function(){return this.isAlreadyRunning},setLSO:function(webUser){TOPI_mySwfStore.set("WUC",webUser)},getLSO:function(){try{return TOPI_mySwfStore.get("WUC")}catch(e){return null}},setLSE:function(webUser){if(TOPI.testStorage()!==false){this.remoteStorage.requestValue("setWULSE",function(key,value){},webUser)}},getFP:function(name){var nameC=name+"=";var valcid=document.cookie.split(';');for(var i=0;i<valcid.length;i++){var c=valcid[i];while(c.charAt(0)==' ')c=c.substring(1,c.length);if(c.indexOf(nameC)==0)return c.substring(nameC.length,c.length)}return null},setFP:function(webUser){var date=new Date();var expdate=new Date();var domaine=document.domain;var extension=domaine.substring(domaine.lastIndexOf("."));var chaineDomaine=new String(domaine);var nomSite=chaineDomaine.replace(extension,"");var domaineComplet=nomSite.substring(nomSite.lastIndexOf("."))+extension;expdate.setTime(date.getTime()+(365*24*60*60*1000));document.cookie="WUF="+webUser+";expires="+expdate.toGMTString()+";path=/ ;domain="+domaineComplet},testStorage:function(){try{return!!localStorage.getItem}catch(e){return false}},init:function(){if(TOPI.testStorage()!==false){this.remoteStorage=new CrossDomainStorage("https://t.publicidees.com//p/topi/lseFrameGet","")}this.isInit=true;if(TOPItmp instanceof Array){if(TOPItmp.length>0){var TOPILength=TOPItmp.length;for(var i=0;i<TOPILength;i++){this.push(TOPItmp[i])}}}},push:function(webUser){this.banners.push(webUser);this.listenBanners()},listenBanners:function(){if(this.getRunning()===true||this.banners.length===0||this.isInit===false){setTimeout("TOPI.listenBanners()",300)}else{this.setRunning(true);this.start()}},isset:function(v){return(v!==""&&v!==null&&typeof v!=='undefined'&&v!=="undefined")},start:function(){this.listenTechnoReady();for(var techno in cTOPI.pitechnos){switch(cTOPI.pitechnos[techno]){case"LSO":this.wucLSO=this.getLSO();if(this.isset(this.wucLSO)){this.canCallSprinkle=true;this.buildScriptTag(this.wucLSO,"LSO")}else{this.flagLSO=true}break;case"TDP":if(this.banners[this.incrementBanners]!==null&&this.banners[this.incrementBanners]!==''){var wuTPStr=new String(this.banners[this.incrementBanners]);var tabWU=wuTPStr.split('!');var wuTP=tabWU[0];if(this.isset(wuTP)){this.canCallSprinkle=true;this.buildScriptTag(wuTP,"TDP")}else{this.flagTDP=true}}else{this.flagTDP=true}break;case"LSE":if(TOPI.testStorage()!==false){this.remoteStorage.requestValue("getWULSE",function(key,value){if(TOPI.isset(value)){TOPI.canCallSprinkle=true;TOPI.buildScriptTag(value,"LSE")}else{TOPI.flagLSE=true;TOPI.technosToMerge.push("LSE")}},null)}else{TOPI.flagLSE=true}break;case"FP":var wuTPStr=new String(this.banners[this.incrementBanners]);var tabWU=wuTPStr.split('!');this.fpProg.push(tabWU[1]);var FPVal=this.getFP('WUF');if(this.isset(FPVal)){this.canCallSprinkle=true;this.buildScriptTag(FPVal,"FP")}else{this.flagFP=true;TOPI.technosToMerge.push("FP")}break}}},listenTechnoReady:function(){if(this.readyToSprinkle()===true||TOPI.counterReadyToSprinkle>=TOPI.counterReadyToSprinkleLimit){TOPI.counterReadyToSprinkle=0;if(this.canCallSprinkle===true){this.callSprinkle()}else{this.resetTOPI();this.setRunning(false)}}else{TOPI.counterReadyToSprinkle=++TOPI.counterReadyToSprinkle;setTimeout("TOPI.listenTechnoReady()",400)}},FlashDetect:new function(){var self=this;self.installed=false;self.raw="";self.major=-1;self.minor=-1;self.revision=-1;self.revisionStr="";var activeXDetectRules=[{"name":"ShockwaveFlash.ShockwaveFlash.7","version":function(obj){return getActiveXVersion(obj)}},{"name":"ShockwaveFlash.ShockwaveFlash.6","version":function(obj){var version="6,0,21";try{obj.AllowScriptAccess="always";version=getActiveXVersion(obj)}catch(err){}return version}},{"name":"ShockwaveFlash.ShockwaveFlash","version":function(obj){return getActiveXVersion(obj)}}];var getActiveXVersion=function(activeXObj){var version=-1;try{version=activeXObj.GetVariable("$version")}catch(err){}return version};var getActiveXObject=function(name){var obj=-1;try{obj=new ActiveXObject(name)}catch(err){obj={activeXError:true}}return obj};var parseActiveXVersion=function(str){var versionArray=str.split(",");return{"raw":str,"major":parseInt(versionArray[0].split(" ")[1],10),"minor":parseInt(versionArray[1],10),"revision":parseInt(versionArray[2],10),"revisionStr":versionArray[2]}};var parseStandardVersion=function(str){var descParts=str.split(/ +/);var majorMinor=descParts[2].split(/\./);var revisionStr=descParts[3];return{"raw":str,"major":parseInt(majorMinor[0],10),"minor":parseInt(majorMinor[1],10),"revisionStr":revisionStr,"revision":parseRevisionStrToInt(revisionStr)}};var parseRevisionStrToInt=function(str){return parseInt(str.replace(/[a-zA-Z]/g,""),10)||self.revision};self.majorAtLeast=function(version){return self.major>=version};self.minorAtLeast=function(version){return self.minor>=version};self.revisionAtLeast=function(version){return self.revision>=version};self.versionAtLeast=function(major){var properties=[self.major,self.minor,self.revision];var len=Math.min(properties.length,arguments.length);for(i=0;i<len;i++){if(properties[i]>=arguments[i]){if(i+1<len&&properties[i]==arguments[i]){continue}else{return true}}else{return false}}};self.FlashDetect=function(){if(navigator.plugins&&navigator.plugins.length>0){var type='application/x-shockwave-flash';var mimeTypes=navigator.mimeTypes;if(mimeTypes&&mimeTypes[type]&&mimeTypes[type].enabledPlugin&&mimeTypes[type].enabledPlugin.description){var version=mimeTypes[type].enabledPlugin.description;var versionObj=parseStandardVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revisionStr=versionObj.revisionStr;self.revision=versionObj.revision;self.installed=true}}else if(navigator.appVersion.indexOf("Mac")==-1&&window.execScript){var version=-1;for(var i=0;i<activeXDetectRules.length&&version==-1;i++){var obj=getActiveXObject(activeXDetectRules[i].name);if(!obj.activeXError){self.installed=true;version=activeXDetectRules[i].version(obj);if(version!=-1){var versionObj=parseActiveXVersion(version);self.raw=versionObj.raw;self.major=versionObj.major;self.minor=versionObj.minor;self.revision=versionObj.revision;self.revisionStr=versionObj.revisionStr}}}}}()}}}if(typeof TOPI_mySwfStore==='undefined'){if(TOPI.FlashDetect.installed===true&&TOPI.inArray(cTOPI.pitechnos,"LSO")){try{var TOPI_mySwfStore=new SwfStore({namespace:"topi",swf_url:(document.location.protocol=="https:"?"https":"http")+"://t.publicidees.com//TOPI/storage.swf",onready:function(){TOPI.init();TOPI.technosToMerge.push("LSO")},onerror:function(){}})}catch(e){}}else{var TOPI_mySwfStore='off';TOPI.flagLSO=true;if(cTOPI.pitechnos.indexOf('LSO')!=-1){cTOPI.pitechnos.splice(cTOPI.pitechnos.indexOf('LSO'),1)}TOPI.init()}}
